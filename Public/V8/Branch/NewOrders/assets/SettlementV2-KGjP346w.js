import{S as H}from"./EntryFile-D68kwv0T.js";/* empty css              */import{C as F}from"./Config-kioEcG-G.js";let p=()=>{let e=document.getElementById("BranchNameId");const n=localStorage.getItem("BranchName").replace("BranOrders","");e!==null&&(e.innerHTML=n);let l=document.getElementById("BranchDisplay");l&&(l.textContent=n)};const C="binV4",B="Custom/Cleaning/Branch/Order/NewOrder/RowSettlement",h="Custom/Cleaning/Branch/Order/NewOrderV1/Settlement",y={OrderKey:"PresentOrder",ItemNamesKey:"ItemNames",AddOnsKey:"AddOns"},j={routePath:C,GetUrl:B,PostUrl:h,localStorageKeys:y};let O=async()=>{let t=S({inGetKey:"OrderNumber"}),e=localStorage.getItem("BranchName"),a=`/${j.GetUrl}/${t}/${e}`;return await fetch(a)},S=({inGetKey:t})=>{const e=window.location.search;return new URLSearchParams(e).get(t)};const v=(t,e,a=!1)=>{let n=document.getElementById(t);n&&(a?n.innerHTML=e:n.value=e)},D=({inData:t})=>{[{id:"OrderAmountId",value:t.Rate,isInnerHTML:!0},{id:"OrderNumberId",value:t.OrderNumber,isInnerHTML:!0},{id:"OrderInfoCustomerNameId",value:t.CustomerName},{id:"BranchNameId",value:t.BranchName},{id:"BranchDisplay",value:t.BranchName},{id:"OrderDate",value:t.Date},{id:"OrderInfoCustomerMobileId",value:t.Mobile}].forEach(({id:a,value:n,isInnerHTML:l})=>v(a,n,l))},d=(t,e)=>{let a=document.getElementById(t);a&&(a.value=e)},N=({inData:t})=>{if(!t.CheckOutData)return"";let{CashAmount:e,UPIAmount:a,CardAmount:n,DiscountPer:l}=t.CheckOutData;d("CashAmountId",e),d("UPIAmountId",a),d("CardAmountId",n),d("DiscountPerId",l)},E=({inData:t})=>{D({inData:t}),N({inData:t})},U=async({inFromFetch:t})=>{if(t.status===200){let e=await t.json();E({inData:e})}t.status};let R=async()=>{{let t=await O();U({inFromFetch:t})}},P=()=>{R()};const $=()=>{P()};let T=async({inSettlementData:t})=>{let e=localStorage.getItem("BranchName"),a=t.inDataToUpdate,n=`/${j.PostUrl}/${t.MainRowPK}/${e}`,l={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)};return await(await fetch(n,l)).json()},w=()=>{b({inGetKey:"BranchName"});let t={};t.DiscountAmount=parseFloat(K())||0,t.CGST=parseFloat(k())||0,t.SGST=parseFloat(M())||0;let e={};return e.MainRowPK=Q(),e.InsertKey="CheckOutData",e.inDataToUpdate={},e.inDataToUpdate.RoundOff=parseFloat(Z())||0,e.inDataToUpdate.CashAmount=parseInt(G())||0,e.inDataToUpdate.CardAmount=parseInt(q())||0,e.inDataToUpdate.UPIAmount=parseInt(J())||0,e.inDataToUpdate.DiscountPer=parseInt(x())||0,e.inDataToUpdate.GstData=t,e},b=({inGetKey:t})=>{const e=window.location.search;return new URLSearchParams(e).get(t)},k=()=>document.getElementById("CgstAmountId").value.trim(),M=()=>document.getElementById("SgstAmountId").value.trim(),K=()=>document.getElementById("DiscountAmountId").value.trim(),x=()=>document.getElementById("DiscountPerId").value.trim(),G=()=>document.getElementById("CashAmountId").value.trim(),q=()=>document.getElementById("CardAmountId").value.trim(),J=()=>document.getElementById("UPIAmountId").value.trim(),Q=()=>document.getElementById("OrderNumberId").innerHTML.trim(),Z=()=>document.getElementById("RoundOffId").value.trim();const r=(t,e=!1)=>{let a=document.getElementById(t);return a?e?a.innerHTML.trim():a.value.trim():0},i=t=>document.getElementById(t),z=()=>{let t=parseInt(r("CashAmountId"))||0,e=parseInt(r("CardAmountId"))||0,a=parseInt(r("UPIAmountId"))||0,n=parseFloat(r("RoundOffId"))||0,l=parseFloat(r("DiscountPerId"))||0,o=parseFloat(r("NettAmountId"))||0,u=t+e+a,m=i("DiscountPerId");return m.classList.remove("is-invalid"),l>10?(m.focus(),m.classList.add("is-invalid"),!1):W()?u!==o+n?(!A("CashAmountId",t)||!A("CardAmountId",e)||!A("UPIAmountId",a)||e>0&&a>0&&f("CashAmountId"),!1):!0:!1},W=()=>{let t=parseFloat(r("NettAmountId"))||0,e=parseFloat(r("RoundOffId"))||0,a=parseInt(r("CashAmountId"))||0,n=parseInt(r("CardAmountId"))||0,l=parseInt(r("UPIAmountId"))||0;if(a+n+l<t+e){let u=i("AmountCheckAlert");return u.classList.remove("d-none"),u.classList.add("show"),!1}return!0},A=(t,e)=>e===0?(f(t),!1):(X(t),!0),f=t=>{let e=i(t);e.focus(),e.classList.add("is-invalid")},X=t=>{let e=i(t);e.classList.contains("is-invalid")&&(e.classList.remove("is-invalid"),e.classList.add("is-valid"))};let Y=({inFromFetch:t})=>{t&&Swal.fire({title:"Settlement Success",confirmButtonText:"Ok"}).then(e=>{e.isConfirmed&&_()})},_=()=>{const t=F.urls.SaveButtonId.redirectToUrl,e=new URL(window.location.href);let a=new URL(t,e);window.location.href=a.href},tt=async()=>{if(z()){let t=w(),e=await T({inSettlementData:t});Y({inFromFetch:e})}};const et=()=>{(()=>{var a=document.querySelector("#AmountCheckAlert .close");a.addEventListener("click",()=>{document.getElementById("AmountCheckAlert").style.display="none"})})();let e=document.getElementById("SaveButtonId");e!==null&&e.addEventListener("click",tt)};let L=document.getElementById("DiscountPerId"),at=()=>{L.addEventListener("keyup",nt)};const nt=lt(()=>ot());function lt(t,e=300){let a;return(...n)=>{clearTimeout(a),a=setTimeout(()=>{t.apply(this,n)},e)}}function ot(){let t=g(),e=document.getElementById("DiscountAmountId");e.value=(t*L.value/100).toFixed(2),Vt({inCgstAmountId:((t-e.value)*(9/100)).toFixed(2)}),At({inSgstAmountId:((t-e.value)*(9/100)).toFixed(2)}),rt()}let rt=()=>{let t=g(),e=document.getElementById("DiscountAmountId"),a=t-e.value,n=st(),l=It();it({inNettAmountId:parseFloat(a)+parseFloat(n)+parseFloat(l)});let o=parseFloat(ut());ct({inRoundOffId:(Math.round(o)-o).toFixed(2)});let u=parseFloat(mt()),m=o+u;dt({inTotalNetAmountId:m})},ut=()=>document.getElementById("NettAmountId").value.trim(),mt=()=>document.getElementById("RoundOffId").value.trim(),dt=({inTotalNetAmountId:t})=>{let a=document.getElementById("TotalNetAmountId");a.innerHTML=t},ct=({inRoundOffId:t})=>{let a=document.getElementById("RoundOffId");a.value=t},st=()=>document.getElementById("SgstAmountId").value.trim(),It=()=>document.getElementById("CgstAmountId").value.trim(),it=({inNettAmountId:t})=>{let a=document.getElementById("NettAmountId");a.value=t.toFixed(2)},At=({inSgstAmountId:t})=>{let a=document.getElementById("SgstAmountId");a.value=t},Vt=({inCgstAmountId:t})=>{let a=document.getElementById("CgstAmountId");a.value=t},g=()=>document.getElementById("OrderAmountId").innerHTML;const c=t=>{var e;return((e=document.getElementById(t))==null?void 0:e.value)||0},jt=(t,e)=>{let a=document.getElementById(t);a&&(a.value=e)},ft=()=>{let t=parseFloat(c("NettAmountId")),e=parseFloat(c("RoundOffId")),a=parseInt(c("CardAmountId"))||0,n=parseInt(c("UPIAmountId"))||0,l=a+n,o=t+e-l;jt("CashAmountId",o.toFixed(0))},Lt=()=>{let t=document.getElementById("CashAmountButtonId");t!==null&&t.addEventListener("click",ft)},s=t=>{var e;return parseFloat((e=document.getElementById(t))==null?void 0:e.value)||0},gt=(t,e)=>{let a=document.getElementById(t);a&&(a.value=e.toFixed(0))},Ht=()=>{let t=s("NettAmountId"),e=s("RoundOffId"),a=s("CashAmountId"),n=s("UPIAmountId"),l=a+n,o=t+e-l;gt("CardAmountId",o)},Ft=()=>{let t=document.getElementById("CardAmountButtonId");t!==null&&t.addEventListener("click",Ht)},I=t=>{var e;return parseFloat((e=document.getElementById(t))==null?void 0:e.value)||0},pt=(t,e)=>{let a=document.getElementById(t);a&&(a.value=e.toFixed(0))},Ct=()=>{let t=I("NettAmountId"),e=I("RoundOffId"),a=I("CashAmountId"),n=I("CardAmountId"),l=a+n,o=t+e-l;pt("UPIAmountId",o)},Bt=()=>{let t=document.getElementById("UPIAmountButtonId");t!==null&&t.addEventListener("click",Ct)};let ht=()=>{et(),at(),Lt(),Ft(),Bt()};const V=()=>{p(),$(),ht(),yt()};let yt=()=>{let t=new Event("keyup");document.getElementById("DiscountPerId").dispatchEvent(t)};const Ot=()=>{H({inSuccessFunc:V})&&V()};Ot();
