import"./modulepreload-polyfill-B5Qt9EMX.js";import"./EntryFile-Dg-mTZIw.js";let m=async()=>{document.getElementById("RefreshBSTableId").click()};const h="binV3",u="",v="Custom/Cleaning/Branch/Today/V1/OrdersWithQrs",f={StartRoute:h,tableName:u,Url:v};let C=async()=>{let e=localStorage.getItem("BranchName"),a=` /${f.Url}/${e}`;return await await fetch(a)},V=e=>{var a=$("#table");let t=e.filter(l=>l.IsQrCodesRaised===!0);a.bootstrapTable("load",t)},g=async()=>{let e=await C();e.status===200&&V(await e.json())},p=()=>{let e=document.getElementById("RefreshBSTableId");e!==null&&e.addEventListener("click",g)},S=()=>{p()};const b="#toolbar",L="true",F="true",D="pk",j="true",B=[],w="5",H="",I=[{field:"KS-Serial",title:"#",formatter:"jFGlobalSerialColumn",class:"d-none d-sm-table-cell"},{field:"pk",title:"Order #"},{field:"CustomerData.CustomerName",title:"Customer Name"},{field:"CustomerData.inMobileNumber",title:"Mobile",class:"d-none d-sm-table-cell"},{title:"Qr Print",field:"TotalItems"},{title:"Print",field:"OrderPrint"},{title:"Pcs",field:"AggValues.ItemDetails",width:"100",footerFormatter:"pcsFormatter",class:"d-none d-sm-table-cell"},{title:"Settlement",field:"AggValues.SettlementAmount",formatter:"symbolFormatPrice",align:"right",class:"d-none d-sm-table-cell"}],d={toolbar:b,search:L,searchable:F,idfield:D,showFooter:j,data:B,pageSize:w,onClickRow:H,columns:I};let Z=({inFindColumn:e})=>{e.formatter=N},N=(e,a,t)=>t+1,y=({inFindColumn:e})=>{e.formatter=T};function T(e){return this.field,"₹ "+e}let A=({inFindColumn:e})=>{e.formatter=M,e.footerFormatter=O};function M(e,a,t){return a.IsQrCodesRaised?['<a href="#" class="btn btn-primary QRGenerateClass">','<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-qr-code" viewBox="0 0 16 16">','<path d="M2 2h2v2H2V2Z"></path>','<path d="M6 0v6H0V0h6ZM5 1H1v4h4V1ZM4 12H2v2h2v-2Z"></path>','<path d="M6 10v6H0v-6h6Zm-5 1v4h4v-4H1Zm11-9h2v2h-2V2Z"></path>','<path d="M10 0v6h6V0h-6Zm5 1v4h-4V1h4ZM8 1V0h1v2H8v2H7V1h1Zm0 5V4h1v2H8ZM6 8V7h1V6h1v2h1V7h5v1h-4v1H7V8H6Zm0 0v1H2V8H1v1H0V7h3v1h3Zm10 1h-1V7h1v2Zm-1 0h-1v2h2v-1h-1V9Zm-4 0h2v1h-1v1h-1V9Zm2 3v-1h-1v1h-1v1H9v1h3v-2h1Zm0 0h3v1h-2v1h-1v-2Zm-4-1v1h1v-2H7v1h2Z">',"</path>",'<path d="M7 12h1v3h4v1H7v-4Zm9 2v2h-3v-1h2v-1h1Z"></path>',"</svg>"," ",`${a.TotalItems}`,"</a>"].join(""):[`<a href="#" data-rowpk="${a.pk}" class="btn btn-outline-primary QRGenerateClass">`,'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-qr-code" viewBox="0 0 16 16">','<path d="M2 2h2v2H2V2Z"></path>','<path d="M6 0v6H0V0h6ZM5 1H1v4h4V1ZM4 12H2v2h2v-2Z"></path>','<path d="M6 10v6H0v-6h6Zm-5 1v4h4v-4H1Zm11-9h2v2h-2V2Z"></path>','<path d="M10 0v6h6V0h-6Zm5 1v4h-4V1h4ZM8 1V0h1v2H8v2H7V1h1Zm0 5V4h1v2H8ZM6 8V7h1V6h1v2h1V7h5v1h-4v1H7V8H6Zm0 0v1H2V8H1v1H0V7h3v1h3Zm10 1h-1V7h1v2Zm-1 0h-1v2h2v-1h-1V9Zm-4 0h2v1h-1v1h-1V9Zm2 3v-1h-1v1h-1v1H9v1h3v-2h1Zm0 0h3v1h-2v1h-1v-2Zm-4-1v1h1v-2H7v1h2Z">',"</path>",'<path d="M7 12h1v3h4v1H7v-4Zm9 2v2h-3v-1h2v-1h1Z"></path>',"</svg>"," ",'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-circle" viewBox="0 0 16 16">','<path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"></path>','<path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"></path>',"</svg>","</a>"].join("")}function O(e){var a=this.field;return+e.map(function(t){return+t[a]}).reduce(function(t,l){return t+l},0)}let k=({inFindColumn:e})=>{e.formatter=x};function x(e,a,t){if(a.IsQrCodesRaised)return[`<a href="./Bill.html?OrderNumber=${a.pk}" target="_blank" class="btn btn-warning">`,'<i class="bi bi-printer-fill"></i>',"</a>"].join("")}let Q=({inColumns:e})=>{let a=e,t=a.find(o=>o.field==="KS-Serial"),l=a.find(o=>o.field==="AggValues.SettlementAmount"),n=a.find(o=>o.field==="TotalItems"),r=a.find(o=>o.field==="OrderPrint");l!==void 0&&y({inFindColumn:l}),t!==void 0&&Z({inFindColumn:t}),n!==void 0&&A({inFindColumn:n}),r!==void 0&&k({inFindColumn:r})},R=({inFindColumn:e})=>{e.footerFormatter=P};function P(e){this.field;var a=e.map(function(l){return+l.AggValues.ItemDetails.split(" / ")[1]}).reduce(function(l,n){return l+n},0),t=e.map(function(l){return+l.AggValues.ItemDetails.split(" / ")[0]}).reduce(function(l,n){return l+n},0);return`${t}/${a}`}let q=({inFindColumn:e})=>{e.footerFormatter=E};function E(e){return this.field,"₹ "+e.map(function(a){return+a.AggValues.SettlementAmount}).reduce(function(a,t){return a+t},0)}let G=({inColumns:e})=>{let a=e,t=a.find(n=>n.field==="AggValues.ItemDetails"),l=a.find(n=>n.field==="AggValues.SettlementAmount");t!==void 0&&R({inFindColumn:t}),l!==void 0&&q({inFindColumn:l})},z=({inColumns:e})=>{Q({inColumns:e}),G({inColumns:e})},U=async({inRow:e})=>{var a=e.pk;let t=`/Custom/Cleaning/Branch/QrCode/V1/Filter/OrderNumber/${a}`;return await await(await fetch(t)).json()},J=({inData:e,inRow:a})=>{let t=e,n=document.getElementById("TemplateForQrCodePrint").content.cloneNode("true");i({inClone:n,inHtmlClassName:"BranchClass",inTextContent:t.BookingData.OrderData.BranchName}),i({inClone:n,inHtmlClassName:"PkClass",inTextContent:t.location}),i({inClone:n,inHtmlClassName:"QrCodeClass",inTextContent:t.UuId}),i({inClone:n,inHtmlClassName:"OrderNumberClass",inTextContent:t.OrderNumber}),i({inClone:n,inHtmlClassName:"ItemNameClass",inTextContent:t.ItemName}),i({inClone:n,inHtmlClassName:"ItemSerialClass",inTextContent:t.ItemSerial}),i({inClone:n,inHtmlClassName:"AddOnDataAsStringClass",inTextContent:t.AddOnDataAsString}),i({inClone:n,inHtmlClassName:"DateTimeClass",inTextContent:new Date(t.BookingData.OrderData.Currentdateandtime).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"2-digit"}).split("/").join("-")}),i({inClone:n,inHtmlClassName:"OrderDateClass",inTextContent:new Date(t.DeliveryDateTime).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"2-digit"}).split("/").join("-")});let r=n.getElementById("CanvasId");return console.log("jVarLocalDataNeeded",t),r.dataset.qrcode=`${t.pk}~`,r.dataset.qrcode+=`${t.pk}-${t.OrderNumber}~`,r.dataset.qrcode+=`${t.BookingData.OrderData.BranchName}-${t.location}~`,r.dataset.qrcode+=`${t.ItemName}~`,r.dataset.qrcode+=`${a.AggValues.ItemDetails}~`,r.dataset.qrcode+=`${t.AddOnDataAsString}~`,r.dataset.qrcode+=`${new Date(t.BookingData.OrderData.Currentdateandtime).toLocaleDateString("en-GB")}@${new Date(t.DeliveryDateTime).toLocaleDateString("en-GB")}`,new XMLSerializer().serializeToString(n)},i=({inClone:e,inHtmlClassName:a,inTextContent:t})=>{let l=e,n=a,r=t,o=l.querySelector(`.${n}`);o.textContent=r},K=({inData:e,inRow:a})=>{let t=e,l=document.getElementById("ModalBody");l.innerHTML="",t.map(s=>{const c=J({inData:s,inRow:a});l.innerHTML+=c});let n=document.querySelectorAll("canvas");for(let s=0;s<n.length;s++){const c=n[s];X({inQrData:t,inCanvasId:c})}let r="ModalForQrCode";var o=new bootstrap.Modal(document.getElementById(r),{keyboard:!0,focus:!0});o.show()},X=({inQrData:e="",inCanvasId:a})=>{var t=a;t.height=1,t.width=1,t.style.visibility="hidden";let l={};l.text=t.dataset.qrcode,l.bcid="qrcode",l.scaleX=1,l.scaleY=1,l.rotate="N";try{let r=new Date;bwipjs.toCanvas(t,l),n(r,new Date)}catch(r){console.log("error : ",r);return}function n(r,o){t.style.visibility="visible"}},Y=({inQrCodeData:e,inRow:a})=>{let t=e;var l=a.pk;const r=localStorage.getItem("BranchName").replace("BranOrders","");let o=t.filter(c=>c.OrderNumber==l&&c.BookingData.OrderData.BranchName==r),s=W({inQrCodeData:o});K({inData:s,inRow:a})},W=({inQrCodeData:e})=>{let a=e.length;return e.map(l=>{let n=l.AddOnArray.map(r=>r.AddOnService);return l.AddOnDataAsString=n.join(", "),l.TotalQrCodes=a,l})},_=async({inRowData:e})=>{var a=e;Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ok",focusCancel:!0,focusButtonColor:"#0000ff"}).then(t=>{t.isConfirmed&&U({inRow:a}).then(l=>{l&&Y({inQrCodeData:l,inRow:a})})})};const tt=(e,a,t)=>{t==="TotalItems"&&_({inRowData:e})},et=$("#table"),at=()=>{z({inColumns:d.columns}),d.onClickRow=tt,et.bootstrapTable(d)};let lt=()=>{let a=document.getElementById("BranchNameId");const l=localStorage.getItem("BranchName").replace("BranOrders","");a!==null&&(a.innerHTML=l)};const nt=()=>{lt(),at(),S()},rt=()=>{nt(),m().then()};rt();
